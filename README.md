# Baseline-Security-Checking-Shell
A shell for checking baseline security of Linux
| 项目名称  | 威胁等级  | 建议操作  | 影响  |
|:----------|:----------|:----------|:----------|
| SSH空闲超时间隔aw | 高危 | 编辑/etc/ssh/sshd_config文件以设置参数：</br>ClientAliveInterval 300  </br>ClientAliveCountMax 0 | 改变ssh远程连接空闲等待时长<br>设置每300秒对本机ssh连接的所用用户发送一条状态信息以检测是否还在活跃<br>0次无响应将断开ssh连接 |
| SSH MaxAuthTries设置为4或更低 | 高危 | 编辑/etc/ssh/sshd_config文件以设置参数，如下所示：<br>MaxAuthTries 4 | 使用ssh时输入密码的允许错误次数<br>超过该次数系统会断开链接<br>可降低系统被暴力破解的风险 |
| 确保已禁用SSH空密码登录  | 高危 | 编辑/etc/ssh/sshd_config文件以设置参数，如下所示：<br>PermitEmptyPasswords no  | 禁止远程 shell 访问密码为空的帐户可降低未经授权访问系统的可能性 |
| 确保配置了密码尝试失败的锁定 | 高危 | 编辑/etc/pam.d/password-auth 和/etc/pam.d/system-auth 文件，以符合本地站点策略：<br>建议严格按照顺序插入<br>auth required pam_faillock.so preauth audit silent deny=5 unlock_time=900<br>auth [success=1 default=bad] pam_unix.so<br>auth [default=die] pam_faillock.so authfail audit deny=5 unlock_time=900<br>auth sufficient pam_faillock.so authsucc audit deny=5 unlock_time=900 | 在连续 n 次不成功的登录尝试后锁定用户 ID 可以减轻针对您的系统的暴力密码攻击。<br>可以设置其他模块选项，建议仅涵盖此处列出的那些。<br>如果用户因为达到了pam_faillock.so 模块中deny= 定义的最大连续失败计数而被锁定，则可以通过分别发出命令faillock -u –reset 来解锁用户。此命令将失败计数设置为 0，从而有效地解锁用户。 |
| 确保默认用户umask限制为027或更高  | 高危 | 编辑/etc/bashrc，/etc/profile和/etc/profile.d/*.sh文件（以及系统上支持的任何其他Shell的适当文件），并添加或编辑umask参数，如下所示：<br>umask 027<br>备注（修复完后运行以下命令以确保是否已完全修复）<br>grep "umask" /etc/bashrc<br>grep "umask" /etc/profile<br>grep "umask" /etc/profile.d/*.sh<br>如果umask配置不为027的，需全部修改为027或更严格 | 为 umask 设置一个非常安全的默认值可确保用户有意识地选择他们的文件权限。<br>默认的 umask 设置 077 会导致用户创建的文件和目录不能被系统上的任何其他用户读取。<br>027 的 umask 将使同一 Unix 组中的用户可以读取文件和目录<br>022 的 umask 将使系统上的每个用户都可以读取文件。 |
| 确保默认用户shell超时为900秒或更短  | 高危 | 编辑/etc/bashrc和/etc/profile文件（以及系统上支持的任何其他Shell的适当文件），并添加或编辑任何umask参数，如下所示：<br>TMOUT=600 | 系统空闲等待600秒，超时自动退出
| 确保已禁用cramfs文件系统的挂载 | 中危 | 编辑或创建文件/etc/modprobe.d/CIS.conf并添加以下行：<br>install cramfs /bin/true<br>运行以下命令卸载cramfs模块：<br>rmmod cramfs | CRAMFS文件系统是专门针对闪存设计的只读压缩文件系统。<br>但因为文件大小限制，读写操作障碍等诸多问题已被淘汰，现只用于小型的嵌入式设备数据读取<br>删除对不需要的文件系统类型的支持减少了服务器的本地攻击面。 |
| 确保禁用freevxfs文件系统的挂载 | 中危 | 编辑或创建文件/etc/modprobe.d/CIS.conf并添加以下行：<br>install freevxfs /bin/true<br>运行以下命令以卸载freevxfs模块<br>rmmod freevxfs | 极为小众的文件系统，支持较多系统，但已经不被大众使用<br>删除对不需要的文件系统类型的支持减少了服务器的本地攻击面。 |
| 确保禁用jffs2文件系统的挂载 | 中危 | 编辑或创建文件/etc/modprobe.d/CIS.conf并添加以下行：<br>install jffs2 /bin/true<br>运行以下命令卸载jffs2模块：<br>rmmod jffs2 | jffs2（日志记录flash文件系统2）文件系统类型是用于闪存设备的日志结构文件系统 |
| 确保禁用hfs文件系统的挂载 | 中危 | 编辑或创建文件/etc/modprobe.d/CIS.conf并添加以下行：<br>install hfs /bin/true<br>运行以下命令卸载hfs模块：<br>rmmod hfs| hfs文件系统类型是一个分层文件系统，允许您安装Mac OS文件系统。|
| 确保禁用hfsplus文件系统的挂载 | 中危 | 编辑或创建文件/etc/modprobe.d/CIS.conf并添加以下行：<br>install hfsplus /bin/true<br>运行以下命令卸载hfsplus模块：<br>rmmod hfsplus | hfsplus 文件系统类型是一种分层文件系统，旨在替换 hfs，允许您挂载 Mac OS 文件系统。 |
| 确保禁用squashfs文件系统的挂载 | 中危 | 编辑或创建文件/etc/modprobe.d/CIS.conf并添加以下行：<br>install squashfs /bin/true<br>运行以下命令卸载squashfs模块：<br>rmmod squashfs | squashfs文件系统类型是一个只读压缩文件系统（类似 cramfs）。squashfs图像无需压缩就可以使用。 |
| 确保禁止挂载udf文件系统 | 中危 | 编辑或创建文件/etc/modprobe.d/CIS.conf并添加以下行：<br>install udf /bin/true<br>运行以下命令以卸载udf模块：<br>rmmod udf |该udf文件系统的类型是用来实现ISO / IEC 13346和ECMA-167规范的通用磁盘格式。这是一种开放的供应商文件系统类型，用于在各种介质上进行数据存储。此文件系统类型对于支持写入DVD和较新的光盘格式是必需的。|
| 确保已禁用FAT文件系统的挂载 | 中危 | 编辑或创建文件/etc/modprobe.d/CIS.conf并添加以下行：<br>install vfat /bin/true<br>运行以下命令以卸载vfat模块：<br>rmmod vfat | FAT文件系统格式，主要用在老版本的Windows系统和便携式USB驱动器或闪存模块。 |
| 确保/var/log存在单独的分区 | 中危 | 对于新安装系统，在安装期间创建自定义分区并为/var/log指定单独的分区。<br>对于先前安装的系统，请创建新分区并根据需要配置/etc/fstab。 | /var/log文件中存放系统的日志文件，其中重要的有：<br>/var/log/btmp 存放所有失败登录的信息<br>/var/log/secure 存放所有的验证和授权的信息<br>/var/log/audit 存放所有授权审计的信息<br>设置单独的分区可以有效保护日志信息 |
| 确保/var/log/audit存在单独的分区 | 中危 | 对于新安装系统，在安装期间创建自定义分区并为/var/log/audit指定单独的分区。<br>对于先前安装的系统，请创建新分区并根据需要配置/etc/fstab。 | 设置单独的分区可以有效保护日志信息 |
| 确保/home存在单独的分区 | 中危 | 对于新安装系统，在安装期间创建自定义分区并为/home指定单独的分区。<br>对于先前安装的系统，请创建新分区并根据需要配置/etc/fstab。 | 改变/home的分区可能会影响相应的用户数据路径 |
| 确保在/dev/shm分区上设置noexec选项 | 中危 | 编辑/etc/fstab文件并将noexec添加到/dev/shm分区的第四个字段<br>运行以下命令重新挂载/dev/shm：<br>mount -o remount noexec /dev/shm<br>sudo mount -o remount,noexec,nosuid,nodev /dev/shm | 使用mount \| grep /dev/shm检测是否挂载noexec<br>noexec挂载选项指定文件系统不能包含可执行二进制文件。 |
| 确保/tmp存在单独的分区 | 中危 | 对于新安装的系统，在安装期间创建自定义分区并为/tmp指定单独的分区。<br>对于先前安装的系统，如果不使用tmpfs，请为/tmp创建新分区。<br>运行以下命令以启用/tmp挂载：<br>systemctl unmask tmp.mount systemctl enable tmp.mount<br>编辑文件 /etc/systemd/system/local-fs.target.wants/tmp.mount进行挂载/tmp配置:<br>[Mount] What=tmpfs Where=/tmp Type=tmpfs<br>Options=mode=1777,strictatime,noexec,nodev,nosuid | /tmp目录是一个全局可写的目录，用于所有用户和某些应用程序的临时存储。 |
| 确保/var/tmp存在单独的分区 | 中危 | 对于新安装的系统，在安装期间创建自定义分区并为/var/tmp指定单独的分区。<br>对于先前安装的系统，请创建新分区并根据需要配置/etc/fstab。 | /var/tmp目录是一个全局可写的目录，用于所有用户和某些应用程序的临时存储 |
| 确保定期检查文件系统完整性 | 中危 | 运行以下命令：<br>crontab -u root -e<br>将以下行添加到crontab中：<br>00 05 * * * /usr/sbin/aide --check |利用aide对文件系统进行定期检查 需要先安装aide<br>yum -y install aide<br>aide --init<br>mv /var/lib/aide/aide.db.new.gz /var/lib/aide/aide.db.gz<br>可以将检测结果放到文件中或利用smtp邮件发送到邮箱里<br>sudo aide --check--report=file:/tmp/aide-check-\` date +%Y%m%d `.txt<br>sudo aide --check \| mail -v -s "AIDE_CHECK_RESULT" xxx@xxx.com<br>使用smtp步骤<br>申请stmp验证码<br>service sendmail stop<br>chkconfig sendmail off<br>service postfix stop<br>chkconfig postfix off<br>sudo vi /etc/mail.rc<br>set from=xxx@qq.com<br>set smtp=smtp.qq.com<br>set smtp-auth-user=xxx@qq.com<br>set smtp-auth-password= #your_authorization_code<br>set smtp-auth=login |
| 确保配置了bootloader配置的权限 | 中危 | 运行以下命令来设置对grub配置的权限：<br>chown root:root /boot/grub2/grub.cfg<br>chmod og-rwx /boot/grub2/grub.cfg | grub配置文件包含有关引导设置的信息以及用于解锁引导选项的密码。 |
| 确保核心转储受到限制 | 中危 | 将以下行添加到/etc/security/limits.conf或/etc/security/limits.d/*文件中：<br>\* hard core 0<br>在/etc/sysctl.conf或/etc/sysctl.d/*文件中设置以下参数：<br>fs.suid_dumpable = 0<br>运行以下命令来设置活动内核参数：<br>sysctl -w fs.suid_dumpable=0 | 核心转储是可执行程序的内存。通常用于确定程序为何中止。它还可以用于从核心文件中收集机密信息。 |
| 确保启用了地址空间布局随机化（ASLR） | 中危 | 在/etc/sysctl.conf或/etc/sysctl.d/*文件中设置以下参数：<br>kernel.randomize_va_space = 2<br>运行以下命令来设置内核参数：<br>sysctl -w kernel.randomize_va_space=2 | 地址空间布局随机化（ASLR）是一种漏洞利用缓解技术，它可以随机排列进程的关键数据区域的地址空间。 |
| 确保正确配置本地登录警告标语 | 中危 | 编辑/etc/issue 根据您的站点策略内容，删除以下实例\m，\r，\s，或\v| /etc/issue 在登录本地终端之前，文件的内容会显示给用户。<br>基于Unix的系统通常会在登录到系统时显示有关OS版本和补丁程序级别的信息。该信息对于为特定OS平台开发软件的开发人员可能有用。如果mingetty(8)支持以下选项，则它们显示操作系统信息：\m -机器体系结构\r -操作系统发行版\s -操作系统名称\v -操作系统版本 |
| 确保正确配置了远程登录警告标语 | 中危 | 编辑/etc/issue.net 根据您的站点策略内容，删除以下任何实例\m，\r，\s，或\v | /etc/issue.net 文件的内容在登录之前向用户显示，以便从已配置的服务进行远程连接。<br>基于Unix的系统通常会在登录到系统时显示有关OS版本和补丁程序级别的信息。该信息对于为特定OS平台开发软件的开发人员可能有用。如果mingetty(8)支持以下选项，则它们显示操作系统信息： \m -机器体系结构\r -操作系统发行版\s -操作系统名称\v -操作系统版本 |
| 确保禁用IP转发 | 中危 | 在/etc/sysctl.conf或/etc/sysctl.d/*文件中设置以下参数：<br>net.ipv4.ip_forward = 0<br>运行以下命令来设置活动的内核参数：<br>sysctl -w net.ipv4.ip_forward=0<br>sysctl -w net.ipv4.route.flush=1 | net.ipv4.ip_forward标志用于告诉系统是否可以转发数据包。 |
| 确保禁用了数据包重定向发送 |  中危 | 在/etc/sysctl.conf或/etc/sysctl.d/*文件中设置以下参数：<br>net.ipv4.conf.all.send_redirects = 0<br>net.ipv4.conf.default.send_redirects = 0<br>运行以下命令来设置活动的内核参数：<br>sysctl -w net.ipv4.conf.all.send_redirects=0<br>sysctl -w net.ipv4.conf.default.send_redirects=0<br>sysctl -w net.ipv4.route.flush=1 | ICMP重定向用于将路由信息发送到其他主机。由于主机本身不充当路由器（在仅主机配置中），因此无需发送重定向。 |
| 确保不接受源路由数据包 | 中危 | 在/etc/sysctl.conf或/etc/sysctl.d/*文件中设置以下参数：<br>net.ipv4.conf.all.accept_source_route = 0<br>net.ipv4.conf.default.accept_source_route = 0<br>运行以下命令来设置活动的内核参数：<br>sysctl -w net.ipv4.conf.all.accept_source_route=0<br>sysctl -w net.ipv4.conf.default.accept_source_route=0<br>sysctl -w  net.ipv4.route.flush=1 | 在网络中，源路由允许发送者部分或完全指定通过网络的路由数据包。相反，非源路由数据包将通过网络中的路由器确定的路径。 | 
| 确保不接受ICMP重定向 | 中危 | 在/etc/sysctl.conf或/etc/sysctl.d/*文件中设置以下参数：<br>net.ipv4.conf.all.accept_redirects = 0<br>net.ipv4.conf.default.accept_redirects = 0<br>运行以下命令来设置活动的内核参数：<br>sysctl -w net.ipv4.conf.all.accept_redirects=0<br>sysctl -w net.ipv4.conf.default.accept_redirects=0<br>sysctl -w net.ipv4.route.flush=1 | CMP重定向消息是传递路由信息并告诉主机（充当路由器）通过备用路径发送数据包的数据包。这是一种允许外部路由设备更新系统路由表的方法。通过设置net.ipv4.conf.all.accept_redirects为0，系统将不接受任何ICMP重定向消息，因此，不允许外部人员更新系统的路由表。 |
| 确保不接受secure ICMP重定向 | 中危 | 在/etc/sysctl.conf或/etc/sysctl.d/*文件中设置以下参数：<br>net.ipv4.conf.all.secure_redirects = 0<br>net.ipv4.conf.default.secure_redirects = 0<br>运行以下命令来设置活动的内核参数：<br>sysctl -w net.ipv4.conf.all.secure_redirects=0<br>sysctl -w net.ipv4.conf.default.secure_redirects=0<br>sysctl -w net.ipv4.route.flush=1 | secure ICMP重定向与ICMP重定向相同，只是它们来自默认网关列表上列出的网关。 |
| 确保记录了可疑数据包 | 中危 | 在/etc/sysctl.conf或/etc/sysctl.d/*文件中设置以下参数：<br>net.ipv4.conf.all.log_martians = 1<br>net.ipv4.conf.default.log_martians = 1<br>运行以下命令来设置活动的内核参数：<br>sysctl -w net.ipv4.conf.all.log_martians=1<br>sysctl -w net.ipv4.conf.default.log_martians=1<br>sysctl -w net.ipv4.route.flush=1 | 启用后，此功能会将具有不可路由源地址的数据包记录到内核日志中。 |
| 确保启用了反向路径过滤 | 中危 | 在/etc/sysctl.conf或/etc/sysctl.d/*文件中设置以下参数：<br>net.ipv4.conf.all.rp_filter = 1<br>net.ipv4.conf.default.rp_filter = 1<br>运行以下命令来设置活动的内核参数：<br>sysctl -w net.ipv4.conf.all.rp_filter=1<br>sysctl -w net.ipv4.conf.default.rp_filter=1<br>sysctl -w net.ipv4.route.flush=1 | 设置net.ipv4.conf.all.rp_filter和net.ipv4.conf.default.rp_filter为1，强制Linux内核以利用反向路径过滤对接收的分组，以确定该分组是否是有效的 |
| 确保启用了TCP SYN Cookies | 中危 | 在/etc/sysctl.conf或/etc/sysctl.d/*文件中设置以下参数：<br>net.ipv4.tcp_syncookies = 1<br>运行以下命令来设置活动的内核参数：<br>sysctl -w net.ipv4.tcp_syncookies=1<br>sysctl -w net.ipv4.route.flush=1 | 攻击者使用SYN泛洪攻击通过发送许多SYN数据包来执行系统上的拒绝服务，而无需完成三次握手。 这将很快耗尽内核半开连接队列中的插槽，并阻止合法连接成功。 SYN cookie允许系统继续接受有效连接，即使在拒绝服务攻击下也是如此。 |
| 确保不接受IPv6路由器通告 | 中危 | 在/etc/sysctl.conf或/etc/sysctl.d/*文件中设置以下参数：<br>net.ipv6.conf.all.accept_ra = 0<br>net.ipv6.conf.default.accept_ra = 0<br>运行以下命令来设置活动的内核参数：<br>sysctl -w net.ipv6.conf.all.accept_ra=0<br>sysctl -w net.ipv6.conf.default.accept_ra=0<br>sysctl -w net.ipv6.route.flush=1 | 此设置禁用系统接受IPv6路由器通告的功能。 |
| 确保不接受IPv6重定向 | 中危 | 在/etc/sysctl.conf或/etc/sysctl.d/*文件中设置以下参数：<br>net.ipv6.conf.all.accept_redirects = 0<br>net.ipv6.conf.default.accept_redirects = 0<br>运行以下命令来设置活动的内核参数：<br>sysctl -w net.ipv6.conf.all.accept_redirects=0<br>sysctl -w net.ipv6.conf.default.accept_redirects=0<br>sysctl -w net.ipv6.route.flush=1 | 此设置可防止系统接受ICMP重定向。ICMP重定向告诉系统有关发送流量的备用路由。 |
| 确保已禁用IPv6 | 中危 | 编辑/etc/default/grub并将'ipv6.disable=1'添加到GRUB_CMDLINE_LINUX参数：<br>GRUB_CMDLINE_LINUX="ipv6.disable=1"<br>运行以下命令以更新grub2配置：<br>grub2-mkconfig > /boot/grub2/grub.cfg | 尽管IPv6相对于IPv4具有许多优势，但是很少有组织实施IPv6。 |
|  确保禁用DCCP | 中危 | 编辑或创建文件/etc/modprobe.d/CIS.conf并添加以下行：<br>install dccp /bin/true | DCCP是支持流媒体的传输层协议。DCCP提供了一种访问拥塞控制的方法，而不必在应用程序层进行，但不提供按序传递。 |
| 确保已禁用SCTP | 中危 | 编辑或创建文件/etc/modprobe.d/CIS.conf并添加以下行：<br>install sctp /bin/true | SCTP是一种传输层协议，用于支持面向消息的通信，一个连接中有多个消息流。它兼有TCP和UDP的功能。它像UDP一样是面向消息的，并通过诸如TCP的拥塞控制来确保可靠的消息顺序传输。 |
| 确保禁用RDS | 中危 | 编辑或创建文件/etc/modprobe.d/CIS.conf并添加以下行：<br>install rds /bin/true | RDS协议是一种传输层协议，旨在提供群集节点之间的低延迟，高带宽通信。它是由Oracle Corporation开发的。|
| 确保禁用TIPC | 中危 | 编辑或创建文件/etc/modprobe.d/CIS.conf并添加以下行：<br>install tipc /bin/true | TIPC协议旨在提供群集节点之间的通信。 |
| 确保配置/etc/crontab上的权限 | 中危 | 运行以下命令以设置/etc/crontab上的所有权和权限：<br>chown root:root /etc/crontab<br>chmod og-rwx /etc/crontab | /etc/crontab文件用于cron控制自己的作业。此项中的命令确保root是文件的用户和组所有者，并且只有所有者可以访问该文件。 |
| 确保配置/etc/cron.hourly上的权限 | 中危 | 运行以下命令以设置/etc/cron.hourly上的所有权和权限：<br>chown root:root /etc/cron.hourly<br>chmod og-rwx /etc/cron.hourly | 此目录包含需要每小时运行的系统cron作业。该目录中的文件无法通过crontab命令进行操作，而是由系统管理员使用文本编辑器进行编辑。以下命令限制对用户和组root的读/写和搜索访问，从而阻止常规用户访问此目录。 |
| 确保配置/etc/cron.daily上的权限 | 中危 | 运行以下命令以设置/etc/cron.daily上的所有权和权限：<br>chown root:root /etc/cron.daily<br>chmod og-rwx /etc/cron.daily | 此目录包含需要每天运行的系统cron作业。该目录中的文件无法通过crontab命令进行操作，而是由系统管理员使用文本编辑器进行编辑。以下命令限制对用户和组root的读/写和搜索访问，从而阻止常规用户访问此目录。 |
| 确保配置/etc/cron.weekly上的权限 | 中危 | 运行以下命令以设置/etc/cron.weekly上的所有权和权限：<br>chown root:root /etc/cron.weekly<br>chmod og-rwx /etc/cron.weekly | 此目录包含需要每星期运行的系统cron作业。该目录中的文件无法通过crontab命令进行操作，而是由系统管理员使用文本编辑器进行编辑。以下命令限制对用户和组root的读/写和搜索访问，从而阻止常规用户访问此目录。 |
| 确保配置/etc/cron.monthly上的权限 | 中危 | 运行以下命令以设置/etc/cron.monthly上的所有权和权限：<br>chown root:root /etc/cron.monthly<br>chmod og-rwx /etc/cron.monthly | 此目录包含需要每月运行的系统cron作业。该目录中的文件无法通过crontab命令进行操作，而是由系统管理员使用文本编辑器进行编辑。以下命令限制对用户和组root的读/写和搜索访问，从而阻止常规用户访问此目录。 |
| 确保配置/etc/cron.d上的权限 | 中危 | 运行以下命令以设置/etc/cron.d上的所有权和权限：<br>chown root:root /etc/cron.d <br>chmod og-rwx /etc/cron.d | /etc/cron.d目录包含系统cron作业。 crontab命令无法操作此目录中的文件，而是由系统管理员使用文本编辑器进行编辑。以下命令限制对用户和组root的读/写和搜索访问，从而阻止常规用户访问此目录。 |
| 确保禁用SSH PermitUserEnvironment| 中危 | 编辑/etc/ssh/sshd_config文件以设置参数，如下所示：<br>PermitUserEnvironment no | PermitUserEnvironment选项允许用户向ssh守护程序提供环境选项。 |
| 确保仅使用经过批准的MAC算法 | 中危  | 编辑/etc/ssh/sshd_config文件以设置参数：<br>MACs hmac-sha2-512-etm@openssh.com,hmac-sha2-256-etm@openssh.com,umac-128-etm@openssh.com,hmac-sha2-512,hmac-sha2-256,umac-128@openssh.com | 此变量限制SSH在通信期间可以使用的MAC算法类型。 |
| 确保SSH LoginGraceTime设置为一分钟或更短 | 中危 | 编辑/etc/ssh/sshd_config文件以设置参数，如下所示：<br>LoginGraceTime 60 | LoginGraceTime参数指定成功认证SSH服务器所需的时间。宽限期越长，未经身份验证的连接就越开放。 |
| 确保SSH访问受限 | 中危 | 编辑/etc/ssh/sshd_config文件以设置一个或多个参数，如下所示：<br>AllowUsers \<userlist> AllowGroups \<grouplist> DenyUsers \<userlist> DenyGroups \<grouplist> | 有几个选项可用于限制哪些用户和组可以通过SSH访问系统。 |
| 确保已配置SSH警告标语 | 中危 | 编辑/etc/ssh/sshd_config文件以设置参数，如下所示：<br>Banner /etc/issue.net  | Banner参数指定一个文件，其内容必须在允许进行身份验证之前发送给远程用户。默认情况下，不显示任何标语。 |
| 确保SSH协议设置为2 | 中危 | 编辑/etc/ssh/sshd_config文件以设置参数，如下所示：<br>Protocol 2 | SSH支持两种不同且不兼容的协议：SSH1和SSH2。 SSH1是原始协议，受安全问题的影响。 SSH2更先进，更安全。 |
| 确保SSH LogLevel设置为INFO | 中危 | 编辑/etc/ssh/sshd_config文件以设置参数，如下所示：<br>LogLevel INFO | INFO参数将记录登录和注销活动。 |
| 确保禁用SSH X11转发 | 中危 | 编辑/etc/ssh/sshd_config文件以设置参数，如下所示：<br>X11Forwarding no | X11Forwarding参数提供了通过连接建立X11通信隧道的功能，以启用远程图形连接。 |
| 确保已启用SSH IgnoreRhosts | 中危 | 编辑/etc/ssh/sshd_config文件以设置参数，如下所示：<br>IgnoreRhosts yes  | IgnoreRhosts参数指定.rhosts和.shosts文件不会在RhostsRSAAuthentication或HostbasedAuthentication中使用。 |
| 确保已禁用SSH基于主机的身份验证 | 中危 | 编辑/etc/ssh/sshd_config文件以设置参数，如下所示：<br>HostbasedAuthentication no  |HostbasedAuthentication参数指定是否允许.rhosts或/etc/hosts.equiv的用户通过公钥客户端进行主机身份验证。此选项仅适用于SSH协议版本2 |
| 确保禁用SSH root登录 | 中危 | 编辑/etc/ssh/sshd_config文件以设置参数，如下所示：<br>PermitRootLogin no  | PermitRootLogin参数指定root用户是否可以使用ssh登录。默认值为no |
| 确保用户拥有自己的主目录 | 中危 | 将已定义用户不拥有的所有主目录的所有权更改为正确的用户。 | 用户主目录是为特定用户定义的空间，用于设置本地环境变量和存储个人文件。 |
| 确保gpgcheck已全局激活 | 低危 | 编辑/etc/yum.conf并设置' gpgcheck=1' [main]。<br>编辑/etc/yum.repos.d/* 中的所有失败文件，并将所有实例设置gpgcheck为“ 1”。 | gpgcheck选项确定在安装RPM软件包之前是否对其签名进行了检查。 |
| 确保审核日志不会自动删除 | 低危 | 在/etc/audit/auditd.conf中设置以下参数 :<br>max_log_file_action = keep_logs | 设置max_log_file_action 值为keep_logs，当审核日志文件达到最大文件大小时将不删除旧日志 |
| 确保在审核日志已满时禁用系统 | 低危 | 该配置会在日志满后触发守护进程关闭系统(该配置有让系统关闭中断的风险，对于需要持续生产的环境不建议进行该项配置，对于日志记录及安全要求高的环境可进行该项配置)<br>在 /etc/audit/auditd.conf中设置以下参数:<br>space_left_action = email<br>action_mail_acct = root<br>admin_space_left_action = halt | 当审计日志都满了，auditd守护程序可以被配置为停止系统。 |
| 确保系统管理范围（sudoers）更改的收集 | 低危 | 将以下行添加到/etc/audit/rules.d/audit.rules文件中：<br>-w /etc/sudoers -p wa -k scope<br>-w /etc/sudoers.d/ -p wa -k scope<br>执行上述操作后，请重启audit服务：<br>service auditd restart | 监视系统管理范围更改。如果已正确配置系统以强制系统管理员先以自己的身份登录，然后使用该sudo命令执行特权命令，则可以监视更改。该文件/etc/sudoers被写入或其属性已更改为。审核记录将使用标识符“scope”标记 |
| 确保收集了系统管理员操作（sudolog） | 低危 | 将以下行添加到/etc/audit/rules.d/audit.rules文件中：<br>-w /var/log/sudo.log -p wa -k actions<br>执行上述操作后，请重启audit服务：<br>service auditd restart | 监视sudo日志文件。如果系统已正确配置为禁用该su命令，并强制所有管理员必须先登录然后sudo才能执行特权命令，则所有管理员命令都将登录到/var/log/sudo.log。每当执行命令时，审计事件都会触发，并且已执行的管理命令将被写入日志。|
| 确保审核配置是不变的 | 低危 | 将以下行添加到/etc/audit/rules.d/audit.rules文件末尾。<br>-e 2<br>执行上述操作后，请重启audit服务：<br>service auditd restart | 设置系统审核，以便不能使用auditctl修改审核规则。设置标志“ -e 2”将强制审核设置为不可变模式。审核设置更改只能在系统重新引导时进行。 |
| 确保启用对在auditd之前启动的进程的审计 | 低危 | 编辑/etc/default/grub并将audit = 1添加到GRUB_CMDLINE_LINUX：<br>GRUB_CMDLINE_LINUX="audit=1"<br>运行以下命令以更新grub2配置：<br>grub2-mkconfig -o /boot/grub2/grub.cfg | 对grub进行配置， 以便即使进程比auditd更早启动也可以对其进行审计 |
| 确保收集了修改用户/组信息的事件 | 低危 | 将以下行添加到/etc/audit/rules.d/audit.rules文件中：<br>-w /etc/group -p wa -k identity<br>-w /etc/passwd -p wa -k identity<br>-w /etc/gshadow -p wa -k identity<br>-w /etc/shadow -p wa -k identity<br>-w /etc/security/opasswd -p wa -k identity<br>执行上述操作后，请重启audit服务：<br>service auditd restart | 记录影响group，passwd（用户ID）shadow和gshadow（密码）或/etc/security/opasswd文件的事件 |
| 确保收集了修改系统的强制访问控制的事件 | 低危 | 将以下行添加到/etc/audit/rules.d/audit.rules文件中：<br>-w /etc/selinux/ -p wa -k MAC-policy<br>-w /usr/share/selinux/ -p wa -k MAC-policy<br>执行上述操作后，请重启audit服务：<br>service auditd restart | 监控SELinux强制访问控制。/etc/selinux目录的任何写访问（可能在目录中添加，删除或修改文件）或属性更改都会被监控 |
| 确保收集了登录和注销事件 | 低危 | 将以下行添加到/etc/audit/rules.d/audit.rules文件中：<br>-w /var/log/lastlog -p wa -k logins<br>-w /var/run/faillock/ -p wa -k logins<br>执行上述操作后，请重启audit服务：<br>service auditd restart | 监视登录和注销事件。跟踪与登录/注销事件关联的文件的更改。该文件/var/log/lastlog保留用户最后一次成功登录的记录。该/var/run/failock 目录保留通过pam_faillock 模块登录失败的记录。 |
| 确保收集了会话启动信息 | 低危 | 将以下行添加到/etc/audit/rules.d/audit.rules文件中：<br>-w /var/run/utmp -p wa -k session<br>-w /var/log/wtmp -p wa -k logins<br>-w /var/log/btmp -p wa -k logins<br>执行上述操作后，请重启audit服务：<br>service auditd restart | 监视会话启动事件。跟踪与会话事件关联的文件的更改。该文件/var/run/utmp跟踪所有当前登录的用户。所有审核记录都将标记有标识符“会话”。/var/log/wtmp文件跟踪登录，注销，关闭和重新启动事件。 |
